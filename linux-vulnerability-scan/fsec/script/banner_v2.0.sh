#!/bin/bash

banner(){
  echo "
  ############################## << WARNING >> ###############################

  본 시스템은 ${COMPANY_NAME}의 보안설비로 허가된 사용자만 이용할 수 있습니다.
  부당한 방법으로 전산망에 접속하거나 정보를 삭제/변경/유출하는 사용자는
  관련 법령에 따라 처벌 받게 됩니다.

  This system is a security facility of ${COMPANY_NAME} and can only be used
  by authorized users. Users who access the computer network or
  delete/change/leak information in an unreasonable way will be punished
  according to relevant laws and regulations.

  ############################################################################
  " > /etc/issue.net
}

login_script(){
  cat > /etc/profile.d/login_script.sh << 'EOF'
  USED_MEM=$(free -m | grep Mem | awk '{print $3}')
  TOTAL_MEM=$(free -m | grep Mem | awk '{print $2}')
  MEM_USAGE=$(awk "BEGIN {printf \"%.2f\", ${USED_MEM}/${TOTAL_MEM}*100}")

  USED_ROOT_DIR=$(df -Th | grep '/$' | awk '{print $4}')
  TOTAL_ROOT_DIR=$(df -Th | grep '/$' | awk '{print $3}')
  DISK_USAGE=$(df -Th | grep '/$' | awk '{print $6}')

  last_login(){
    local current_user
    current_user=$(whoami)
    last -n 1 "$current_user" | head -n 1 | tail -n 1 | awk '{print $4 " " $5 " " $6 " " $7}'
  }

  echo "

  ================ System Information ================
  OS...........: $(grep PRETTY_NAME /etc/os-release | awk -F= '{print $2}' | tr -d '"')
  CPU..........: $(grep -c processor /proc/cpuinfo) core
  Kernel.......: $(uname -r)
  IP...........: $(hostname -I)
  Memory.......: ${USED_MEM} MB / ${TOTAL_MEM} MB (${MEM_USAGE}%)
  DISK(/)......: ${USED_ROOT_DIR} / ${TOTAL_ROOT_DIR} (${DISK_USAGE}%)
  Server Name..: $(hostname)

  ================= User Information =================
  User Name....: $(whoami)
  Last Login...: $(last_login)

  ================= Welcome ! $(whoami) ! =============

  "
EOF
}